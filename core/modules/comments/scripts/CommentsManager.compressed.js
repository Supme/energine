ScriptLoader.load("GridManager");var CommentsManager=new Class({Extends:GridManager,initialize:function(a){this.parent(a)},loadPage:function(c){this.pageList.disable();this.toolbar.disableControls();this.overlay.show();this.grid.clear();var b="",a=this.singlePath+"get-data/page-"+c;if(this.langId){b+="languageID="+this.langId+"&"}if(this.filter.active&&this.filter.query.value.length>0){var d=this.filter.fields.options[this.filter.fields.selectedIndex].value;b+="filter"+d+"="+this.filter.query.value+"&"}if(this.grid.sort.order){a=this.singlePath+"get-data/"+this.grid.sort.field+"-"+this.grid.sort.order+"/page-"+c}b+="tab_index="+this.getNumCurrTab()+"&";this.request(a,b,function(e){if(!this.initialized){this.grid.setMetadata(e.meta);this.initialized=true}this.grid.setData(e.data||[]);this.grid.build();this.pageList.build(e.pager.count,e.pager.current);this.overlay.hide();if(this.grid.isEmpty()){if(control=this.toolbar.getControlById("add")){control.enable()}}else{this.toolbar.enableControls();this.pageList.enable()}}.bind(this))},edit:function(){ModalBox.open({url:this.singlePath+this.grid.getSelectedRecordKey()+"/edit/"+this.getNumCurrTab()+"/tab",onClose:this.loadPage.pass(this.pageList.currentPage,this)})},getNumCurrTab:function(){return $$("div.e-pane-t-toolbar ul.e-pane-toolbar li.current").getAllPrevious().flatten().length},approve:function(){var a=this.singlePath+this.grid.getSelectedRecordKey()+"/approve/";var b="tab_index="+this.getNumCurrTab()+"&";var c=this.grid.getSelectedItem().getElement("img");this.request(a,b,function(d){if(d.result){c.setProperty("src","images/checkbox_on.png")}}.bind(this))},del:function(){var a=Energine.translations.get("MSG_CONFIRM_DELETE")||"Do you really want to delete selected record?";if(confirm(a)){this.request(this.singlePath+this.grid.getSelectedRecordKey()+"/delete/"+this.getNumCurrTab()+"/tab",null,this.loadPage.pass(this.pageList.currentPage,this))}}});