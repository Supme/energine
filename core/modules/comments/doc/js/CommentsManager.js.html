<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: comments/scripts/CommentsManager.js</title>
    
    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">
    
    <h1 class="page-title">Source: comments/scripts/CommentsManager.js</h1>
    
    


    
    <section>
        <article>
            <pre class="prettyprint source"><code>/**
 * @file Contain the description of the next classes:
 * &lt;ul>
 *     &lt;li>[CommentsManager]{@link CommentsManager}&lt;/li>
 * &lt;/ul>
 *
 * @requires share/Energine
 * @requires share/GridManager
 *
 * @author Pavel Dubenko
 *
 * @version 1.0.0
 */

ScriptLoader.load('GridManager');

/**
 * CommentsManager
 *
 * @augments GridManager
 *
 * @constructor
 * @param {Element|string} element The main holder element.
 */
var CommentsManager = new Class(/** @lends CommentsManager# */{
    Extends: GridManager,

    // constructor
    initialize : function(element) {
        this.parent(element)
    },

    Protected: {
        /**
         * Overridden parent [buildRequestPostBody]{@link GridManager#buildRequestPostBody} method.
         *
         * @memberOf CommentsManager#
         * @abstract
         * @function
         * @protected
         * @returns {string}
         */
        buildRequestPostBody: function() {
            var postBody = '';

            if (this.langId) {
                postBody += 'languageID=' + this.langId + '&';
            }
            if (this.filter.active && this.filter.query.value.length > 0) {
                var fieldName = this.filter.fields.options[this.filter.fields.selectedIndex].value;
                postBody += 'filter' + fieldName + '=' + this.filter.query.value + '&';
            }
            postBody += 'tab_index=' + this.getNumCurrTab() + '&';

            return postBody;
        }
    },

    // todo: This is not current - this is the last.
    /**
     * Get the number of the current tab.
     *
     * @function
     * @public
     * @returns {Number}
     */
    getNumCurrTab: function(){
        return $$('div.e-pane-t-toolbar ul.e-pane-toolbar li.current').getAllPrevious().flatten().length
    },

    // todo: Is this somewhere used?
    /**
     * Approve action.
     * @function
     * @public
     */
    approve: function(){
        var url = this.singlePath + this.grid.getSelectedRecordKey() + '/approve/',
            postBody = 'tab_index=' + this.getNumCurrTab() + '&',
            selectedItem = this.grid.getSelectedItem().getElement('img');

        Energine.request(url, postBody, function(result) {
            if (result['result']) {
                selectedItem.setProperty('src','images/checkbox_on.png');
            }
        });
    },

    /**
     * Overridden [edit]{@link GridManager#edit} action.
     * @function
     * @public
     */
    edit: function() {
        ModalBox.open({
            url: this.singlePath + this.grid.getSelectedRecordKey() + '/edit/' + this.getNumCurrTab() + '/tab',
            onClose: this.loadPage.pass(this.pageList.currentPage, this)
        });
    },

    /**
     * Overridden [del]{@link GridManager#del} action.
     * @function
     * @public
     */
    del: function() {
        var MSG_CONFIRM_DELETE = Energine.translations.get('MSG_CONFIRM_DELETE') ||
            'Do you really want to delete selected record?';
        if (confirm(MSG_CONFIRM_DELETE)) {
            Energine.request(
                this.singlePath + this.grid.getSelectedRecordKey() +
                    '/delete/' + this.getNumCurrTab() + '/tab',
                null,
                this.loadPage.pass(this.pageList.currentPage, this)
            );
        }
    }
});
</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Index</a></h2><h3>Classes</h3><ul><li><a href="CommentsForm.html">CommentsForm</a></li><li><a href="CommentsManager.html">CommentsManager</a></li><li><a href="Grid.html">Grid</a></li><li><a href="GridManager.html">GridManager</a></li><li><a href="GridManager.Filter.html">Filter</a></li><li><a href="GridManager.Filter.QueryControls.html">QueryControls</a></li><li><a href="ValidForm.html">ValidForm</a></li></ul><h3>Events</h3><ul><li><a href="CommentsForm.html#event:keyup">keyup</a></li><li><a href="Grid.html#event:doubleClick">doubleClick</a></li><li><a href="Grid.html#event:select">select</a></li><li><a href="Grid.html#event:sortChange">sortChange</a></li></ul><h3>Namespaces</h3><ul><li><a href="Energine.html">Energine</a></li></ul><h3>Global</h3><ul><li><a href="global.html#ScriptLoader">ScriptLoader</a></li></ul>
</nav>

<br clear="both">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.3.0-dev</a> on Thu Dec 05 2013 13:38:35 GMT+0200 (EET)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
