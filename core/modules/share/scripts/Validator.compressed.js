var Validator=new Class({initialize:function(b,a){this.form=$(b);this.tabPane=a||null;this.prepareFloatFields()},prepareFloatFields:function(){var a=function(b){b=new Event(b||window.event);b.target.value=b.target.value.replace(/\,/,".")};this.form.getElements(".float").each(function(b){b.removeEvent("change",a);b.addEvent("change",a)})},removeError:function(b){if(b.hasClass("invalid")){b.removeClass("invalid");var a;if(a=b.getParent().getParent().getElement("div.error")){a.dispose()}}},showError:function(b,a){this.removeError(b);b.addClass("invalid");new Element("div").addClass("error").appendText("^ "+a).injectAfter(b.parentNode)},scrollToElement:function(c){var b=(b=document.getElement(".e-mainframe"))?b:window;var a=new Fx.Scroll(b,{offset:{x:-30,y:-20},transition:Fx.Transitions.linear});a.toElement(c).chain(function(){try{c.focus()}catch(d){}})},validateElement:function(field){var result=true;var pattern,message;field=$(field);if((pattern=field.getProperty("nrgn:pattern"))&&(message=field.getProperty("nrgn:message"))&&!field.getProperty("disabled")&&!field.hasClass("novalidation")){if(!eval("field.value.match("+pattern+");")){this.showError(field,message);if(!field.getProperty("check")){field.addEvent("blur",this.validateElement.bind(this,field));field.addEvent("keydown",this.removeError.bind(this,field));field.setProperty("check","check")}result=false}else{this.removeError(field)}}return result},validate:function(){var a=[];new Elements(this.form.elements).each(function(d){if(!this.validateElement(d)){a.push(d)}},this);if(a.length){var b=a[0];if(this.tabPane){this.tabPane.show(this.tabPane.whereIs(b))}this.scrollToElement(b);try{b.focus()}catch(c){}}return !(a.length)}});