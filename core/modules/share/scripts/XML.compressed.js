var XML={rootFromFile:function(c){var a=null;switch(Browser.Engine.name){case"webkit":var b=new XMLHttpRequest();b.open("GET",c,false);b.send(null);return b.responseXML;case"trident":a=new ActiveXObject("Microsoft.XMLDOM");default:a=a||document.implementation.createDocument("","",null)}a.async=false;a.load(c);return a},rootFromString:function(b){var a;if(Browser.Engine.trident){a=new ActiveXObject("Microsoft.XMLDOM");a.async=false;a.loadXML(b)}else{a=new DOMParser().parseFromString(b,"text/xml")}return a},rootToHashes:function(b){var c=[],e=b.childNodes;for(var d=0,a=e.length;d<a;d++){var f=XML.nodeToHash(e[d]);if(f){c.push(f)}}return c},nodeToHash:function(e){switch($type(e)){case"element":var a=e.attributes;var f=a.length;var c={};for(var b=0;b<f;b++){var d=a[b];if(d.nodeValue&&d.nodeValue!="inherit"){c[d.nodeName]=d.nodeValue}}return{tag:e.nodeName.toLowerCase(),attributes:c,children:XML.rootToHashes(e)};case"textnode":return{text:e.nodeValue};default:return null}},hashesToTree:function(d){var a=[];for(var c=0,b=d.length;c<b;c++){a.push(XML.hashToElement(d[c]))}return a},hashToElement:function(c,a){var b;if(c.text){b=document.newTextNode(c.text)}else{b=document.newElement(a||c.tag,c.attributes).adopt(XML.hashesToTree(c.children))}return b},hashToHTML:function(f,h){var d=new Array(h||0).join("\t");if(f.text){return d+f.text}var a=[""];for(var e in f.attributes){a.push(e+'="'+f.attributes[e]+'"')}a=a.join(" ");var b=d+"<"+f.tag+a+">";var g=d+"</"+f.tag+">";var c=XML.hashesToHTML(f.children,h+1);return b+c+g},hashesToHTML:function(b,e){var d=[];for(var c=0,a=b.length;c<a;c++){d.push(XML.hashToHTML(b[c],e))}return d.join("\n")},transform:function(h,d){h=(typeof h=="string")?XML.rootFromFile(h):h;d=(typeof d=="string")?XML.rootFromFile(d):d;var m=document.newElement("div");if(Browser.Engine.trident){var g=h.transformNode(d);m.innerHTML=g}else{var a=new XSLTProcessor();a.importStylesheet(d);var k=a.transformToFragment(h,document);m.appendChild(k)}var b=[];for(var f=0,c=m.childNodes.length;f<c;f++){var e=m.childNodes[f],j=$type(e);if(j=="element"||j=="textnode"){b.push(e)}}return b}};